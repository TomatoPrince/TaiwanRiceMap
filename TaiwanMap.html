<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>首頁</title>
  <script  src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>

  <script type="text/javascript" src="http://d3js.org/topojson.v1.min.js"></script>
  <link rel="stylesheet" href="css/all.css">
  <script type="text/javascript" src=""></script>
  <style>
  body {
      background-color: #cceeff;
  }

  .subunit-boundary {
      fill: none;
      stroke: #fff;
      stroke-dasharray: 5, 0;
      stroke-linejoin: round;
  }
  </style>
</head>
<body>
  <div id='panel' style="display: none">
    <span id='title'></span><br />
  </div>  
  <script>
    var width = 800,
        height = 600;

    var svg = d3.select("body").append("svg")
        // .attr("class", "svgback")
        .attr("width", width)
        .attr("height", height);
    var projection = d3.geo.mercator()
        .center([121,24])
        .scale(6000);

    var path = d3.geo.path()
        .projection(projection);
    d3.json("county.json", function(error, topology) {
        var g = svg.append("g");
        
        // 縣市/行政區界線
        d3.select("svg").append("path").datum(
                topojson.mesh(topology,
                        topology.objects["county"], function(a,
                                b) {
                            return a !== b;
                        })).attr("d", path).attr("class","subunit-boundary");
        
        d3.select("g").selectAll("path")
              .data(topojson.feature(topology, topology.objects.county).features)
              .enter()
              .append("path")
              .attr("d", path)
              .attr({
                    d : path,
                    name : function(d) {
                        return d.properties["C_Name"];
                    },
                    fill : '#55AA00'
            });
    });
// 顯示滑鼠所指向的縣市/行政區
    d3.select("svg").selectAll("path").on("mouseenter", function() {
        // console.log(e);
        fill = $(this).attr("fill");
        $(this).attr("fill", '#00DD77');
    
        $('#title').html($(this).attr("name"));
        $('#panel').css({
            "height" : "20px",
            "width" : "60px"
        });
    }).on("mouseout", function() {
        $(this).attr("fill", fill);
    });
    
    // panel 隨滑鼠移動
    $("path").mouseover(function(e) {
        
        if($('#panel').is(':visible')){
            $('#panel').css({
                'top' : e.pageY,
                'left' : e.pageX
            });
        } else {
            $('#panel').fadeIn('slow').fadeOut();
        }
    });
  </script>
</body>
</html>